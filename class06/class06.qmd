---
title: "Class 6: R functions"
author: "Georgina Canto-Encalada (A59021295)"
Date: 01/26/24
format: pdf
---

# Our first silly function

All functions in R have 3 parts. They have:

- a name
- input arguments (none,one or more)
- a body

A function to add two numbers

```{r sillyfun}
sillyadd <- function(x,y=1) {
  x+y
}
```

Let me try out this function

```{r}

sillyadd(100)

```

# Let's do something more useful

# Since Covid is in the air, I will not be so harsh with them. Then, I will consider a missing assigment as the lowest one. If there is more than one missing assigment, one of them will be dropped and the others will be considarated as zero
```{r}
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
grades <- data.frame(student1,student2,student3)
grades[is.na(grades)] <- 0
grades
```



```{r}
grade<- function(x,drop.lowest=TRUE){

  # Transform all NA values to 0
  x[is.na(x)] <- 0
  if(drop.lowest){
    # Find the index of the minimum value
    min <- x[-which.min(x)]
    # Measure the mean of their grades
    ans<-mean(min)
  }
  else {
    ans<-mean(x)
    
  }

}
```

```{r}
grade(student1)
grade(student2)
grade(student3)
```
Read a class gradebook CSV file from here: “https://tinyurl.com/gradeinput” 

```{r}
url<- "https://tinyurl.com/gradeinput"
gradebook <- read.csv(url,row.names=1)
gradebook

```

We can "apply" our new grade() function over wither the rows or the columns of the gradebook, with MARGIN=1 pr MARGIN=2
```{r}
results <- apply(gradebook,1,grade)
results
```

> **Q2.** Using your grade() function and the supplied gradebook, Who is the top scoring student overall in the gradebook? [3pts]

```{r}
which.max(results)
```

>**Q3.** From your analysis of the gradebook, which homework was toughest on students (i.e. obtained the lowest scores overall? [2pts]

```{r}
which.min(apply(gradebook,2,mean,na.rm=T))

```

>**Q4.** Optional Extension: From your analysis of the gradebook, which homework was most
predictive of overall score (i.e. highest correlation with average grade score)? [1pt]

```{r}
mask<-gradebook
mask[is.na(mask)]<-0
mask

which.max(apply(mask,2,cor,y=results))


```

